(function(e){function t(t){for(var r,a,o=t[0],c=t[1],u=t[2],l=0,p=[];l<o.length;l++)a=o[l],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&p.push(s[a][0]),s[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);h&&h(t);while(p.length)p.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,a=1;a<n.length;a++){var c=n[a];0!==s[c]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},s={app:0},i=[];function a(e){return o.p+"js/"+({}[e]||e)+"."+{"chunk-2d0e892b":"c22dd9d8"}[e]+".js"}function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.e=function(e){var t=[],n=s[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=s[e]=[t,r]}));t.push(n[2]=r);var i,c=document.createElement("script");c.charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.src=a(e);var u=new Error;i=function(t){c.onerror=c.onload=null,clearTimeout(l);var n=s[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+r+": "+i+")",u.name="ChunkLoadError",u.type=r,u.request=i,n[1](u)}s[e]=void 0}};var l=setTimeout((function(){i({type:"timeout",target:c})}),12e4);c.onerror=c.onload=i,document.head.appendChild(c)}return Promise.all(t)},o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/sheets_manager_excel_addin/",o.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var h=u;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"2e3d":function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t),n.d(t,"i18n",(function(){return Zt}));n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("ce4a"),n("2e3d");var r,s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("header",{staticClass:"header"},[n("navigation-tabs",{attrs:{isSettingsActive:e.isSettingsActive},on:{"turn-on-settings":function(t){return e.changeSettingsState(!0)}}})],1),n("settings-modal",{attrs:{isSettingsActive:e.isSettingsActive},on:{"turn-off-settings-state":function(t){return e.changeSettingsState(!1)}}}),n("NItems",{attrs:{pElements:e.elements},on:{"elements-change":e.changeElements}})],1)},i=[],a=(n("96cf"),n("1da1")),o=n("d4ec"),c=n("bee2"),u=n("262e"),l=n("2caf"),h=n("9ab4"),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("NModal",{attrs:{isActive:e.isSettingsActive,title:e.$t("settings.header")},on:{close:e.turnOffSettings,save:e.turnOffSettings},scopedSlots:e._u([{key:"modalBody",fn:function(){return[n("div",{staticClass:"form",class:{"--is-dark":e.isDarkTheme}},[n("div",{staticClass:"form__field"},[n("checkbox",{attrs:{text:e.$t("settings.sheetsNumerationEnabled"),value:e.isNumerated},on:{click:e.changeIsNumerated}})],1),n("div",{staticClass:"form__field"},[n("checkbox",{attrs:{text:e.$t("settings.darkTheme"),value:e.isDarkTheme},on:{click:e.changeIsDarkTheme}})],1),n("div",{staticClass:"form__field"},[n("checkbox",{attrs:{text:e.$t("settings.showNumeration"),value:e.showNumeration},on:{click:e.switchNumeration}})],1),n("div",{staticClass:"form__p --is-centered --has-underline"},[e._v(" "+e._s(e.$t("settings.settingsOnStart"))+" ")]),n("div",{staticClass:"form__field"},[n("checkbox",{attrs:{text:e.$t("settings.openIntroTutorial"),value:e.runIntroOnOpen},on:{click:e.switchIntroOnOpenState}})],1),n("div",{staticClass:"form__field"},[n("checkbox",{attrs:{text:e.$t("settings.tryToRecoverNumeration"),value:e.shouldWeRestoreNumeration},on:{click:e.changeShouldWeRestoreNumeration}})],1),n("div",{staticClass:"form__field"},[e._v(" "+e._s(e.$t("settings.chooseLanguage"))+" "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.$i18n.locale,expression:"$i18n.locale"}],staticClass:"select",on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.$i18n,"locale",t.target.multiple?n:n[0])}}},e._l(e.langs,(function(t,r){return n("option",{key:"Lang"+r,domProps:{value:t}},[e._v(e._s(t))])})),0)])])]},proxy:!0}])})},d=[],m=(n("99af"),n("60a3")),v=n("6fc5"),f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(o["a"])(this,e),this.areSheetsHaveNumeration=t,this.isNumerationBroken=n,this.shouldWeRestoreNumeration=r,this.default={},this.default.areSheetsHaveNumeration=t,this.default.isNumerationBroken=n,this.default.shouldWeRestoreNumeration=r}return Object(c["a"])(e,[{key:"resetToDefault",value:function(){this.areSheetsHaveNumeration=this.default.areSheetsHaveNumeration,this.isNumerationBroken=this.default.isNumerationBroken,this.shouldWeRestoreNumeration=this.default.shouldWeRestoreNumeration}}]),e}();(function(e){e["danger"]="danger",e["success"]="success",e["loading"]="loading",e["dimmer"]="dimmer"})(r||(r={}));var g=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.themeName="dark",e.isTouchDevice=!1,e.maintainerStatuses=new f,e.showNumeration=!0,e.alert={title:"",type:r.loading,isOpen:!1},e.intro={step:0,isRunning:!1},e.runIntroOnOpen=!0,e}return Object(c["a"])(n,[{key:"setAllSettings",value:function(e){var t=e.themeName,n=e.maintainerStatuses,r=e.runIntroOnOpen,s=e.showNumeration;this.themeName=t,this.runIntroOnOpen=r,this.showNumeration=s,this.maintainerStatuses=new f(n.areSheetsHaveNumeration,n.isNumerationBroken,n.shouldWeRestoreNumeration)}},{key:"setTheme",value:function(e){this.themeName=e}},{key:"setThemeAct",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.context.commit("setTheme",t);case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setIsTouchDevice",value:function(e){this.isTouchDevice=e}},{key:"switchSheetsNumerationMut",value:function(e){this.maintainerStatuses.default.shouldWeRestoreNumeration=e,this.maintainerStatuses.default.areSheetsHaveNumeration=e,this.maintainerStatuses.resetToDefault()}},{key:"changeShouldWeRestoreNumeration",value:function(e){this.maintainerStatuses.shouldWeRestoreNumeration=e,this.maintainerStatuses.default.shouldWeRestoreNumeration=e}},{key:"switchSheetsNumeration",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.maintainerStatuses.areSheetsHaveNumeration,r=void 0!==t?t:!n,this.switchSheetsNumerationMut(r),s=!0,r!=s){e.next=9;break}return e.next=7,this.context.dispatch("Sheets/initializeStore",null,{root:!0});case 7:e.next=11;break;case 9:return e.next=11,this.context.dispatch("Sheets/cleanNumerationIni",null,{root:!0});case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"switchShowNumeration",value:function(){this.showNumeration=!this.showNumeration}},{key:"openAlert",value:function(e){var t=this,n=e.title,r=e.type;this.alert.type=r,this.alert.title=n,this.alert.isOpen=!0,setTimeout((function(){t.alert.title==n&&t.alert.type==r&&(t.alert.isOpen=!1)}),5e3)}},{key:"closeAlert",value:function(){this.alert.title="",this.alert.isOpen=!1}},{key:"loading",value:function(e){var t=this;if(e){this.alert.type=r.loading;var n="Загрузка...";this.alert.title=n,this.alert.isOpen=!0,setTimeout((function(){t.alert.isOpen&&t.alert.type==r.loading&&t.alert.title==n&&(t.alert.type=r.danger,t.alert.title="Не удается выполнить загрузку! Пожалуйста перезагрузите аддин")}),1e5)}else this.alert.title="",this.alert.isOpen=!1}},{key:"dimmer",value:function(e){e?(this.alert.type=r.dimmer,this.alert.title="",this.alert.isOpen=!0):(this.alert.title="",this.alert.isOpen=!1)}},{key:"switchIntroState",value:function(){this.intro.isRunning=!this.intro.isRunning}},{key:"setIntroStep",value:function(e){this.intro.step=e}},{key:"switchRunIntroOnOpen",value:function(){this.runIntroOnOpen=!this.runIntroOnOpen}},{key:"getAllSettings",get:function(){return{themeName:this.themeName,maintainerStatuses:JSON.parse(JSON.stringify(this.maintainerStatuses)),runIntroOnOpen:this.runIntroOnOpen,showNumeration:this.showNumeration}}},{key:"getIsDarkTheme",get:function(){var e="dark";return this.themeName==e}},{key:"getIsTouchDevice",get:function(){return this.isTouchDevice}},{key:"getMaintainerStatuses",get:function(){var e=new f(this.maintainerStatuses.areSheetsHaveNumeration,this.maintainerStatuses.isNumerationBroken,this.maintainerStatuses.shouldWeRestoreNumeration);return e}},{key:"getShouldWeRestoreNumeration",get:function(){return this.maintainerStatuses.default.shouldWeRestoreNumeration}},{key:"getShowNumeration",get:function(){return this.showNumeration}},{key:"getAlertState",get:function(){return this.alert}},{key:"getIntroIsRunning",get:function(){return this.intro.isRunning}},{key:"getIntroStep",get:function(){return this.intro.step}},{key:"getRunIntroOnOpen",get:function(){return this.runIntroOnOpen}}]),n}(v["d"]);Object(h["a"])([v["c"]],g.prototype,"setAllSettings",null),Object(h["a"])([v["c"]],g.prototype,"setTheme",null),Object(h["a"])([v["a"]],g.prototype,"setThemeAct",null),Object(h["a"])([v["c"]],g.prototype,"setIsTouchDevice",null),Object(h["a"])([v["c"]],g.prototype,"switchSheetsNumerationMut",null),Object(h["a"])([v["c"]],g.prototype,"changeShouldWeRestoreNumeration",null),Object(h["a"])([v["a"]],g.prototype,"switchSheetsNumeration",null),Object(h["a"])([v["c"]],g.prototype,"switchShowNumeration",null),Object(h["a"])([v["c"]],g.prototype,"openAlert",null),Object(h["a"])([v["c"]],g.prototype,"closeAlert",null),Object(h["a"])([v["c"]],g.prototype,"loading",null),Object(h["a"])([v["c"]],g.prototype,"dimmer",null),Object(h["a"])([v["c"]],g.prototype,"switchIntroState",null),Object(h["a"])([v["c"]],g.prototype,"setIntroStep",null),Object(h["a"])([v["c"]],g.prototype,"switchRunIntroOnOpen",null),g=Object(h["a"])([Object(v["b"])({name:"AppSettings",namespaced:!0})],g);var b=g,k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"checkbox",class:{"--is-dark":e.isDarkTheme},on:{click:e.changeValue}},[n("div",{staticClass:"checkbox__input"},[n("svg",{directives:[{name:"show",rawName:"v-show",value:e.isChecked,expression:"isChecked"}],staticClass:"checkbox__svg",attrs:{viewBox:"0 0 10 10"}},[n("path",{attrs:{d:"\n                        M 2,6\n                        L 5,8\n                        L 8,2\n                    "}})])]),n("p",{staticClass:"checkbox__label"},[e._v(" "+e._s(e.text)+" ")])])},y=[],O=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(c["a"])(n,[{key:"changeValue",value:function(){this.$emit("click")}},{key:"isDarkTheme",get:function(){var e=Object(v["e"])(b,this.$store);return e.getIsDarkTheme}},{key:"isChecked",get:function(){return 1==this.$props.value}}]),n}(m["c"]);O=Object(h["a"])([Object(m["a"])({props:["value","text"],components:{}})],O);var _=O,w=_,x=n("2877"),S=Object(x["a"])(w,k,y,!1,null,null,null),j=S.exports,N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"modal",class:{"--is-active":e.isActive},on:{click:e.turnOffCancel}},[n("div",{ref:"card",staticClass:"modal__card",class:{"--is-dark":e.isDarkTheme},on:{click:function(e){e.stopPropagation()}}},[n("header",{staticClass:"modal__card-head"},[e.isBookmarksActive?n("div",{staticClass:"modal__bookmarks"},[e._t("bookmarks")],2):e._e(),e.showSave?n("div",{staticClass:"modal__card-save",on:{click:e.turnOffSave}},[n("span",{staticClass:"icon --has-accent",class:{"--is-dark":e.isDarkTheme}},[n("i",{staticClass:"fas fa-save"})])]):e._e(),n("p",{staticClass:"modal__card-title --has-accent"},[e._v(e._s(e.title))]),e.showClose?n("div",{staticClass:"modal__card-close",on:{click:e.turnOffCancel}},[n("span",{staticClass:"icon --has-accent",class:{"--is-dark":e.isDarkTheme}},[n("i",{staticClass:"fas fa-times"})])]):e._e()]),n("section",{staticClass:"modal__card-body"},[e._t("modalBody")],2)])])},E=[],C=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(c["a"])(n,[{key:"bookmarkClicked",value:function(e){this.$emit("b-click",e)}},{key:"turnOffCancel",value:function(){this.$emit("close")}},{key:"turnOffSave",value:function(){this.$emit("save")}},{key:"isBookmarksActive",get:function(){return void 0!==this.$slots["bookmarks"]}},{key:"isDarkTheme",get:function(){var e=Object(v["e"])(b,this.$store);return e.getIsDarkTheme}}]),n}(m["c"]);Object(h["a"])([Object(m["b"])({required:!1,default:!0})],C.prototype,"showSave",void 0),Object(h["a"])([Object(m["b"])({required:!1,default:!0})],C.prototype,"showClose",void 0),C=Object(h["a"])([Object(m["a"])({props:{isActive:{type:Boolean,required:!0,default:!1},title:{type:String,required:!1,default:""}},components:{Checkbox:j}})],C);var R,T=C,I=T,$=Object(x["a"])(I,N,E,!1,null,null,null),D=$.exports;(function(e){e["rus"]="rus",e["eng"]="eng"})(R||(R={}));var A=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.langs=[R.eng,R.rus],e._isTouchDevice=!1,e}return Object(c["a"])(n,[{key:"changeShouldWeRestoreNumeration",value:function(){var e=!this.shouldWeRestoreNumeration,t=Object(v["e"])(b,this.$store);t.changeShouldWeRestoreNumeration(e);var n="".concat(this.$t("alerts.numerationRecover")," ").concat(e?this.$t("alerts.activated"):this.$t("alerts.deactivated"));this.$i18n.locale==R.rus&&(n="".concat(n,"о")),t.openAlert({title:n,type:r.success})}},{key:"switchIntroOnOpenState",value:function(){var e=Object(v["e"])(b,this.$store),t=!this.runIntroOnOpen;e.switchRunIntroOnOpen();var n="".concat(this.$t("alerts.onOpenTutorial")," ").concat(t?this.$t("alerts.activated"):this.$t("alerts.deactivated"));this.$i18n.locale==R.rus&&(n="".concat(n,"о")),e.openAlert({title:n,type:r.success})}},{key:"changeIsDarkTheme",value:function(){var e=Object(v["e"])(b,this.$store),t=e.getIsDarkTheme;1==t?e.setTheme("base"):e.setTheme("dark")}},{key:"changeIsTouchDevice",value:function(){this.$data._isTouchDevice=!this.$data._isTouchDevice}},{key:"changeIsNumerated",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=Object(v["e"])(b,this.$store),t.loading(!0),n=!this.isNumerated,s="".concat(this.$t("alerts.numeration")," ").concat(n?this.$t("alerts.activated"):this.$t("alerts.deactivated")),this.$i18n.locale==R.rus&&(s="".concat(s,"a")),e.next=7,t.switchSheetsNumeration();case 7:t.openAlert({title:s,type:r.success});case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"turnOffSettings",value:function(){this.$emit("turn-off-settings-state")}},{key:"switchNumeration",value:function(){var e=Object(v["e"])(b,this.$store),t=!this.showNumeration;e.switchShowNumeration();var n="".concat(this.$t("alerts.numerationVisibility")," ").concat(t?this.$t("alerts.activated"):this.$t("alerts.deactivated"));this.$i18n.locale==R.rus&&(n="".concat(n,"а")),e.openAlert({title:n,type:r.success})}},{key:"clearNumeration",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"shouldWeRestoreNumeration",get:function(){var e=Object(v["e"])(b,this.$store);return e.getShouldWeRestoreNumeration}},{key:"runIntroOnOpen",get:function(){var e=Object(v["e"])(b,this.$store);return e.getRunIntroOnOpen}},{key:"isDarkTheme",get:function(){var e=Object(v["e"])(b,this.$store);return e.getIsDarkTheme}},{key:"isTouchDevice",get:function(){return this.$data._isTouchDevice}},{key:"isNumerated",get:function(){var e=Object(v["e"])(b,this.$store);return e.getMaintainerStatuses.areSheetsHaveNumeration}},{key:"showNumeration",get:function(){var e=Object(v["e"])(b,this.$store);return e.getShowNumeration}}]),n}(m["c"]);A=Object(h["a"])([Object(m["a"])({props:{isSettingsActive:{type:Boolean,required:!0,default:!1}},components:{Checkbox:j,NModal:D}})],A);var W=A,M=W,P=Object(x["a"])(M,p,d,!1,null,null,null),L=P.exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tabs",class:{"--is-dark":e.isDarkTheme}},[n("div",{staticClass:"tabs__tab",attrs:{"data-v-step":"header-search"},on:{mouseover:function(t){return e.changeIsSearchActive(!0)},mouseleave:function(t){return e.changeIsSearchActive(!1)},click:function(t){return e.changeIsSearchActive(!0,!0)}}},[n("div",{staticClass:"search --has-accent",class:{"--is-open":e.isSearchActive,"--is-dark":e.isDarkTheme}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.searchingWord,expression:"searchingWord"}],staticClass:"search__input",attrs:{type:"text"},domProps:{value:e.searchingWord},on:{input:function(t){t.target.composing||(e.searchingWord=t.target.value)}}}),e._m(0)])]),n("div",{staticClass:"tabs__tab",attrs:{"data-v-step":"header-sync"},on:{click:e.sync}},[n("div",{staticClass:"button --has-accent",class:{"--is-dark":e.isDarkTheme}},[e._m(1)])]),n("div",{staticClass:"tabs__tab",attrs:{"data-v-step":"header-settings"},on:{click:e.turnOnSettings}},[n("div",{staticClass:"button --has-accent",class:{"--is-dark":e.isDarkTheme}},[e._m(2)])]),n("div",{staticClass:"tabs__tab",attrs:{"data-v-step":"header-help"},on:{click:e.turnOnTutorial}},[n("div",{staticClass:"button --has-accent",class:{"--is-dark":e.isDarkTheme}},[e._m(3)])]),n("div",{staticClass:"tabs__tab",attrs:{"data-v-step":"header-info"},on:{click:e.turnOnInfo}},[n("div",{staticClass:"button --has-accent",class:{"--is-dark":e.isDarkTheme}},[e._m(4)])]),n("ModalInfo",{attrs:{isActive:e.isInfoActive},on:{close:e.closeInfo}})],1)},B=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search__icon"},[n("span",{staticClass:"icon"},[n("i",{staticClass:"fas fa-search"})])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"icon__refresh"},[n("i",{staticClass:"fa fa-refresh"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"icon"},[n("i",{staticClass:"fas fa-sliders-h"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"icon"},[n("i",{staticClass:"fas fa-question"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"icon"},[n("i",{staticClass:"fas fa-info"})])}],F=(n("b0c0"),n("d3b7"),n("ddb0"),n("3835")),z=n("b85c"),q=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=function(){function e(t){Object(o["a"])(this,e),Promise.resolve(this.build(t))}return Object(c["a"])(e,[{key:"build",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=6;break}return e.next=3,q();case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=this._context=t;case 7:this._context=e.t0;case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"context",value:function(){return this._context}},{key:"sync",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this._context.sync();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}],[{key:"init",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,q();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),Y=n("e317"),G=function(){function e(){Object(o["a"])(this,e)}return Object(c["a"])(e,[{key:"init",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new V(t),e.next=3,n.build();case 3:this.context=n.context();case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getWorksheets",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=this._contextWorksheets(),t.load("items"),e.next=5,this.sync();case 5:return e.abrupt("return",t.items);case 8:throw e.prev=8,e.t0=e["catch"](0),Y["Log"].error("ExcelWorksheets.getWorksheets",e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"getWorksheet",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,n=this._contextWorksheets(),r=n.getItem(t),e.next=5,this.sync();case 5:return e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e["catch"](0),Y["Log"].error("ExcelWorksheets.getWorksheets",e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getActiveWorksheet",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=this._contextWorksheets().getActiveWorksheet(),e.next=4,this.sync();case 4:return e.abrupt("return",t);case 7:throw e.prev=7,e.t0=e["catch"](0),Y["Log"].error("ExcelWorksheets.getActiveWorksheet",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"setActiveWorksheet",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,n=this._contextWorksheets().getItem(t),n.activate(),e.next=5,this.sync();case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e["catch"](0),Y["Log"].error("ExcelWorksheets.getActiveWorksheet",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"renameWorksheet",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){var r,s,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=!(i.length>2&&void 0!==i[2])||i[2],e.prev=1,s=this._getWorksheet(t),s.name=n,!r){e.next=7;break}return e.next=7,this.sync();case 7:return e.abrupt("return",!0);case 10:throw e.prev=10,e.t0=e["catch"](1),Y["Log"].error("ExcelWorksheets.renameWorksheet",e.t0);case 13:case"end":return e.stop()}}),e,this,[[1,10]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"setWorksheetTabColor",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,r=this._getWorksheet(t),r.tabColor=n,e.next=5,this.sync();case 5:return e.abrupt("return",!0);case 8:throw e.prev=8,e.t0=e["catch"](0),Y["Log"].error("ExcelWorksheets.setWorksheetTabColor",e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"reorderWorksheet",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){var r,s,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=!(i.length>2&&void 0!==i[2])||i[2],e.prev=1,s=this._getWorksheet(t),s.position=n,!r){e.next=7;break}return e.next=7,this.sync();case 7:return e.abrupt("return",!0);case 10:throw e.prev=10,e.t0=e["catch"](1),Y["Log"].error("ExcelWorksheets.reorderWorksheet",e.t0);case 13:case"end":return e.stop()}}),e,this,[[1,10]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"_getWorksheet",value:function(e){return this._contextWorksheets().getItem(e)}},{key:"_contextWorksheets",value:function(){return this.context.workbook.worksheets}},{key:"sync",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.context.sync();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),X=function(){function e(){Object(o["a"])(this,e)}return Object(c["a"])(e,null,[{key:"buildWorksheetsClass",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new G,e.next=3,n.init(t);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),J=(n("a9e3"),n("ac1f"),n("466d"),n("5319"),function e(t){var r=this;Object(o["a"])(this,e),this.delimiter="_";var s=t.typeOfName,i=t._classTitle,a=t.delimiter;this.typeOfName=s,this._classTitle=i||"Basic",a&&(this.delimiter=a),Promise.resolve(Promise.resolve().then(n.bind(null,"e317"))).then((function(e){var t=e.Log;return r.log=new t(r._classTitle)}))}),K=n("ec26"),Q=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(e){var r,s=e.id,i=e.name,a=e.visibility,c=e.color,u=e.typeOfName,l=e.first,h=e.second,p=e.delimiter,d=e.elements,m=e._classTitle;return Object(o["a"])(this,n),r=t.call(this,{typeOfName:u,delimiter:p,_classTitle:m||"SheetElement"}),r._regExpNumeration=/(.\d_\d.)/g,r._regExpPositions=/\d\d/g,r.positions={},r._excelSheetName=i,r.positions={first:l,second:h},r.elements=d||[],r.sourceId=s,r.name=i,r.color=c,r.visibility=a,r.id=Object(K["a"])(),r}return Object(c["a"])(n,[{key:"_doesNameIncludesNumerationPattern",value:function(){try{var e=this._excelSheetName.match(this._regExpNumeration);if(Array.isArray(e)&&e.length>0){var t=e[0].match(this._regExpPositions);if(null===t)return!1;if(2==t.length)return this.positions.first=Number(t[0]),this.positions.second=Number(t[1]),!0}return!1}catch(n){throw this.log.error("_doesNameIncludesNumerationPattern",n)}}},{key:"_numerationPattern",value:function(){try{var e=function(e){return e>9?String(e):"0"+String(e)},t=e(this.positions.first),n=e(this.positions.second),r=t+this.delimiter+n;return r}catch(s){throw this.log.error("_numerationPattern",s)}}},{key:"name",get:function(){try{var e=this[this.typeOfName];return e}catch(t){throw this.log.error("name get",t)}},set:function(e){try{this[this.typeOfName]=e}catch(t){throw this.log.error("name set",t)}}},{key:"decodedName",get:function(){return this._decodedName},set:function(e){this._decodedName=e}},{key:"encodedName",get:function(){return this._encodedName},set:function(e){this._encodedName=e}},{key:"_decodedName",get:function(){try{var e=this._excelSheetName,t=e.replace(this._regExpNumeration,"");return t}catch(n){throw this.log.error("_decodedName get",n)}},set:function(e){try{this._excelSheetName=e}catch(t){throw this.log.error("_decodedName set",t)}}},{key:"_encodedName",get:function(){try{var e=this._decodedName,t=this._numerationPattern();return e+t}catch(n){throw this.log.error("_encodedName get",n)}},set:function(e){try{var t=this._numerationPattern();this._excelSheetName=e+t}catch(n){throw this.log.error("_encodedName set",n)}}}]),n}(J),Z=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n,r,s,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={color:"",name:"test",typeOfName:"_excelSheetName",first:1,second:1,id:"testingID",visibility:"Visible",delimiter:"_",elements:[],_classTitle:void 0},n={color:"",name:"test",typeOfName:"_excelSheetName",first:1,second:0,id:"testing",visibility:"Visible",delimiter:"_",elements:[],_classTitle:void 0},r=new Q(t),s=new Q(t),s.name="te",i=new Q(n),a=new Q(t),a.id="testing2",a.name="testing",i.id="testing1",i.name="testing1",e.abrupt("return",[r,s,i,a]);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=Z,ee=(n("c740"),n("4160"),n("c975"),n("fb6a"),n("a434"),n("4ec9"),n("4fad"),n("3ca3"),n("159b"),n("2909"),n("caad"),n("2532"),function e(t,n,r){try{return n.has(String(t))?(t=r,r++,e(t,n,r)):t}catch(s){throw Y["Log"].error("checkAndTry",s)}}),te=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r,s,i,a,o,c,u,l,h=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=h.length>1&&void 0!==h[1]?h[1]:0,r=h.length>2&&void 0!==h[2]?h[2]:0,s=[],i=Object(z["a"])(t.entries()),e.prev=4,i.s();case 6:if((a=i.n()).done){e.next=17;break}if(o=Object(F["a"])(a.value,2),c=o[0],u=o[1],l=u,0==n?(l.positions.first=c,l.positions.second=0):(l.positions.first=r,l.positions.second=c+1),!(l.elements.length>0)){e.next=14;break}return e.next=13,te(l.elements,1,l.positions.first);case 13:l.elements=e.sent;case 14:s.push(l);case 15:e.next=6;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e["catch"](4),i.e(e.t0);case 22:return e.prev=22,i.f(),e.finish(22);case 25:return e.abrupt("return",s);case 26:case"end":return e.stop()}}),e,null,[[4,19,22,25]])})));return function(t){return e.apply(this,arguments)}}(),ne=function(e){var t=e.oldArr,n=e.requereToCorrectType,r=e.typeOfName;try{var s,i="nonexists",a=new Map,o=Object(z["a"])(t);try{for(o.s();!(s=o.n()).done;){var c=s.value;if(n&&(c.typeOfName=r),c.positions.second>0){var u=c,l=a.get(String(u.positions.first)),h={color:"",name:i,typeOfName:u.typeOfName,first:u.positions.first,second:0,id:"",visibility:"Visible",delimiter:u.delimiter,elements:[],_classTitle:void 0},p=l||new Q(h),d=0==p.elements.length?1:p.elements.length;u.positions.second=d,p.elements.splice(d,0,u),a.set(String(p.positions.first),p)}else{var m=a.size,v=ee(c.positions.first,a,m);c.positions.first=v,a.set(String(c.positions.first),c)}}}catch(j){o.e(j)}finally{o.f()}var f,g=[],b=Object(z["a"])(a.entries());try{for(b.s();!(f=b.n()).done;){var k=Object(F["a"])(f.value,2),y=(k[0],k[1]);if(y.decodedName==i){var O={};if(y.elements.length>0){var _,w=!0,x=Object(z["a"])(y.elements);try{for(x.s();!(_=x.n()).done;){var S=_.value;w?(O=S,O.positions.second=0,w=!1):O.elements.push(S)}}catch(j){x.e(j)}finally{x.f()}}else O=y;g.push(O)}else g.push(y)}}catch(j){b.e(j)}finally{b.f()}return g}catch(N){throw Y["Log"].error("getPositionsAndSortEArr",N)}},re=function(e){Object(u["a"])(r,e);var t=Object(l["a"])(r);function r(e){var n,s=e.typeOfName,i=e.delimiter,a=e._classTitle,c=e.maintainerStatuses;return Object(o["a"])(this,r),n=t.call(this,{_classTitle:a||"SheetElementsMap",typeOfName:s,delimiter:i}),n._arr=[],n.maintainerStatuses=new f,n.maintainerStatuses=new f(c.areSheetsHaveNumeration,c.isNumerationBroken,c.shouldWeRestoreNumeration),n}return Object(c["a"])(r,[{key:"changeElement",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t.positions.second>0,n?(r=this._arr[t.positions.first],r.elements[t.positions.second-1]=t,this._arr[t.positions.first]=r):this._arr[t.positions.first]=t;case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"insertElement",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t.positions.second>0,n?(r=this._arr[t.positions.first],r.elements.splice(t.positions.second-1,0,t),this._arr[t.positions.first]=r):this._arr.splice(t.positions.first,0,t);case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"deleteElement",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){var r,s,i,a,o,c,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n){e.next=4;break}return r=n.positions.second>0,r?(s=this._arr[n.positions.first],s.elements.splice(n.positions.second-1,1),this._arr[n.positions.first]=s):this._arr.splice(n.positions.first,1),e.abrupt("return");case 4:if(t)if(i=this._arr.findIndex((function(e){return e.sourceId==t})),i<0){a=Object(z["a"])(this._arr);try{for(a.s();!(o=a.n()).done;)c=o.value,u=c.elements.findIndex((function(e){return e.sourceId==t})),u>=0&&c.elements.splice(u,1)}catch(l){a.e(l)}finally{a.f()}}else this._arr.splice(i,1);case 5:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"usualSheetChange",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,te(t);case 2:return n=e.sent,this._arr=n,e.next=6,this.writeSheets(n);case 6:return e.next=8,this._sheetsNumerationMaintainer();case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"firstOpenScenarioCreateMatrixElements",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._simpleSheetsLoading(t);case 3:return e.next=5,this._sheetsNumerationMaintainer();case 5:if(n=this.maintainerStatuses,r=n.areSheetsHaveNumeration,s=n.isNumerationBroken,i=n.shouldWeRestoreNumeration,!0!==r||!1!==this.maintainerStatuses.default.areSheetsHaveNumeration||1!=i){e.next=8;break}return e.abrupt("return",!1);case 8:if(!r||s){e.next=13;break}return e.next=11,this.sheetsNumerationRepairer();case 11:e.next=25;break;case 13:if(!r||!s){e.next=18;break}return e.next=16,this.sheetsNumerationRepairer();case 16:e.next=25;break;case 18:if(r||s||!i){e.next=23;break}return e.next=21,this.sheetsNumerationRepairer();case 21:e.next=25;break;case 23:return e.next=25,this.reorderSheetsBasedOnPosition({requereToCorrectType:!1});case 25:return e.abrupt("return",!0);case 28:throw e.prev=28,e.t0=e["catch"](0),this.log.error("firstOpenScenarioCreateSheetElements",e.t0);case 31:case"end":return e.stop()}}),e,this,[[0,28]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"filterElements",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r,s,i,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t.toLowerCase(),r=function(e){var t=e.decodedName,r=t.toLowerCase();r.indexOf(n)>=0&&s.push(e)},s=[],i=Object(z["a"])(this._arr);try{for(i.s();!(a=i.n()).done;)o=a.value,o.elements.length>0&&o.elements.forEach((function(e){r(e)})),r(o)}catch(c){i.e(c)}finally{i.f()}return e.abrupt("return",s);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"sheetsNumerationRepairer",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!this.maintainerStatuses.shouldWeRestoreNumeration){e.next=5;break}return this.typeOfName="_encodedName",e.next=5,this.reorderSheetsBasedOnPosition({requereToCorrectType:!0});case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e["catch"](0),this.log.error("writeSheets",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"reorderSheetsBasedOnPosition",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t.requereToCorrectType,e.prev=1,e.t0=this.typeOfName,e.next="_encodedName"===e.t0?5:15;break;case 5:return r={requereToCorrectType:n,oldArr:this._arr,typeOfName:this.typeOfName},e.next=8,ne(r);case 8:return s=e.sent,e.next=11,te(s);case 11:return i=e.sent,e.next=14,this.writeSheets(i);case 14:return e.abrupt("break",19);case 15:return e.next=17,this.correctDoubles();case 17:return e.next=19,this.writeSheets(this._arr);case 19:e.next=24;break;case 21:throw e.prev=21,e.t1=e["catch"](1),this.log.error("reorderSheets",e.t1);case 24:case"end":return e.stop()}}),e,this,[[1,21]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"correctDoubles",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,r,s,i,a,o,c,u,l,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=[],r=new Map,s=1,i=this._arr,e.next=7,n.e("chunk-2d0e892b").then(n.bind(null,"8a9e"));case 7:a=e.sent,o=a.checkNameAndTryNew,c=Object(z["a"])(i),e.prev=10,c.s();case 12:if((u=c.n()).done){e.next=22;break}if(l=u.value,void 0!==l){e.next=16;break}throw"correctDoubles has sheet === undefined";case 16:h=o(l.decodedName,r,s),l.decodedName=h,r.set(h,h),t.push(l);case 20:e.next=12;break;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e["catch"](10),c.e(e.t0);case 27:return e.prev=27,c.f(),e.finish(27);case 30:return e.next=32,this.writeSheets(t);case 32:e.next=37;break;case 34:throw e.prev=34,e.t1=e["catch"](0),this.log.error("correctDoubles",e.t1);case 37:case"end":return e.stop()}}),e,this,[[0,34],[10,24,27,30]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"writeSheets",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.ReWriteNames(this._arr);case 3:this._arr=e.sent,this._arr=t,e.next=10;break;case 7:throw e.prev=7,e.t0=e["catch"](0),this.log.error("writeSheets",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"_sheetsNumerationMaintainer",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,this.maintainerStatuses.resetToDefault(),t=function(){var e,t=!1,r=Object(z["a"])(n._arr);try{for(r.s();!(e=r.n()).done;){var s=e.value;if(!1===t)t=s._doesNameIncludesNumerationPattern();else if(t&&!s._doesNameIncludesNumerationPattern())return n.maintainerStatuses.isNumerationBroken=!0,t}}catch(i){r.e(i)}finally{r.f()}return t},this.maintainerStatuses.areSheetsHaveNumeration=t(),e.next=9;break;case 6:throw e.prev=6,e.t0=e["catch"](0),this.log.error("_sheetsNumerationMaintainer",e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"ReWriteNames",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=[],r=Object(z["a"])(t),e.prev=2,r.s();case 4:if((s=r.n()).done){e.next=14;break}if(i=s.value,i.decodedName=i.name,!(i.elements.length>0)){e.next=11;break}return e.next=10,this.ReWriteNames(i.elements);case 10:i.elements=e.sent;case 11:n.push(i);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](2),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:return e.abrupt("return",n);case 23:case"end":return e.stop()}}),e,this,[[2,16,19,22]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"createNewSheetElement",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n,r,s,i,a){var o,c,u,l,h,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=(" "+n).slice(1),c=(" "+i).slice(1),u=(" "+a).slice(1),l=(" "+t).slice(1),h={color:c,name:o,typeOfName:this.typeOfName,first:r,second:s,id:l,visibility:u,delimiter:this.delimiter,elements:[],_classTitle:void 0},p=new Q(h),e.abrupt("return",p);case 7:case"end":return e.stop()}}),e,this)})));function t(t,n,r,s,i,a){return e.apply(this,arguments)}return t}()},{key:"_simpleSheetsLoading",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r,s,i,a,o,c,u,l,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,n=[],r=0,s=Object.entries(t);case 3:if(!(r<s.length)){e.next=14;break}return i=Object(F["a"])(s[r],2),a=i[0],o=i[1],c="positions"in o?o.positions:{first:Number(a),second:0},u=c.first,l=c.second,e.next=8,this.createNewSheetElement(o.id,o.name,u,l,o.tabColor,o.visibility);case 8:h=e.sent,h._doesNameIncludesNumerationPattern(),n.push(h);case 11:r++,e.next=3;break;case 14:return e.next=16,this.writeSheets(n);case 16:e.next=21;break;case 18:throw e.prev=18,e.t0=e["catch"](0),this.log.error("_simpleSheetsLoading",e.t0);case 21:case"end":return e.stop()}}),e,this,[[0,18]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getExcelSheets",value:function(){var e,t=[],n=Object(z["a"])(this._arr);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r),r.elements.length>0&&r.elements.forEach((function(e){return t.push(e)}))}}catch(s){n.e(s)}finally{n.f()}return t}},{key:"arrElements",get:function(){return this._arr}}]),r}(J),se={typeOfName:"_excelSheetName",delimiter:"_",_classTitle:"SheetElementsMap",maintainerStatuses:{}},ie=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.outsideApp="browser",e.elements=new re(se),e.filteredSheets=[],e.filterWord="",e.appContext=void 0,e.activeSheetId="",e.editingElement={id:"",isEditing:!1},e}return Object(c["a"])(n,[{key:"setOutsideApp",value:function(e){this.outsideApp=e}},{key:"setSheetsMutation",value:function(e){this.elements.writeSheets(e)}},{key:"setSheets",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.setSheetsMutation(t);case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changeElementsMutation",value:function(e){this.elements=e}},{key:"setFilteredElements",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t.elements,r=t.word,this.filteredSheets=n,this.filterWord=r;case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"filterSheetsByWord",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=[],!(t.length>0)){e.next=5;break}return e.next=4,this.elements.filterElements(t);case 4:n=e.sent;case 5:this.setFilteredElements({elements:n,word:t});case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changeExcelNames",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r,s,i,a,o,c,u,l,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,X.buildWorksheetsClass();case 3:if(n=e.sent,r=this.context.rootGetters["AppSettings/getMaintainerStatuses"],!r.areSheetsHaveNumeration){e.next=25;break}s=Object(z["a"])(t.entries()),e.prev=7,s.s();case 9:if((i=s.n()).done){e.next=15;break}return a=Object(F["a"])(i.value,2),a[0],o=a[1],e.next=13,n.renameWorksheet(o.sourceId,o.name,!1);case 13:e.next=9;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](7),s.e(e.t0);case 20:return e.prev=20,s.f(),e.finish(20);case 23:e.next=42;break;case 25:c=Object(z["a"])(t.entries()),e.prev=26,c.s();case 28:if((u=c.n()).done){e.next=34;break}return l=Object(F["a"])(u.value,2),l[0],h=l[1],e.next=32,n.renameWorksheet(h.sourceId,h.decodedName,!1);case 32:e.next=28;break;case 34:e.next=39;break;case 36:e.prev=36,e.t1=e["catch"](26),c.e(e.t1);case 39:return e.prev=39,c.f(),e.finish(39);case 42:return e.next=44,n.context.sync();case 44:e.next=49;break;case 46:throw e.prev=46,e.t2=e["catch"](0),Y["Log"].error("changeExcelNames",e.t2);case 49:case"end":return e.stop()}}),e,this,[[0,46],[7,17,20,23],[26,36,39,42]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"renameSheet",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=this.elements,e.next=3,n.changeElement(t);case 3:this.changeElementsMutation(n),e.t0=this.outsideApp,e.next="browser"===e.t0?7:"excelDesktop"===e.t0?8:20;break;case 7:return e.abrupt("break",20);case 8:return r=this.context.rootGetters["AppSettings/getMaintainerStatuses"].default.areSheetsHaveNumeration,e.next=11,X.buildWorksheetsClass();case 11:if(s=e.sent,!r){e.next=17;break}return e.next=15,s.renameWorksheet(t.sourceId,t.name);case 15:e.next=19;break;case 17:return e.next=19,s.renameWorksheet(t.sourceId,t.decodedName);case 19:return e.abrupt("break",20);case 20:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changeSheetColor",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=this.elements,e.next=3,n.changeElement(t);case 3:this.changeElementsMutation(n),e.t0=this.outsideApp,e.next="browser"===e.t0?7:"excelDesktop"===e.t0?8:14;break;case 7:return e.abrupt("break",14);case 8:return e.next=10,X.buildWorksheetsClass();case 10:return r=e.sent,e.next=13,r.setWorksheetTabColor(t.sourceId,t.color);case 13:return e.abrupt("break",14);case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changeExcelPositions",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r,s,i,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,X.buildWorksheetsClass();case 2:n=e.sent,r=Object(z["a"])(t.entries()),e.prev=4,r.s();case 6:if((s=r.n()).done){e.next=12;break}return i=Object(F["a"])(s.value,2),a=i[0],o=i[1],e.next=10,n.reorderWorksheet(o.sourceId,a,!1);case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](4),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:return e.next=22,n.context.sync();case 22:case"end":return e.stop()}}),e,null,[[4,14,17,20]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"addNewSheet",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n,r,s){var i,a,o,c,u,l,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,console.log("sheetId",t),e.t0=this.outsideApp,e.next="excelDesktop"===e.t0?5:30;break;case 5:return e.next=7,X.buildWorksheetsClass();case 7:return i=e.sent,e.next=10,i.getWorksheet(t);case 10:return a=e.sent,a.load(["position","name","tabColor","visibility"]),e.next=14,i.context.sync();case 14:return o=r||a.position,c=s||0,u=this.getExcelSheets[a.position],void 0===u?(u=this.getExcelSheets[a.position-1],u.positions.second>0?(o=u.positions.first,c=u.positions.second+1):o=u.positions.first+1):u.positions.second>0?(o=u.positions.first,c=u.positions.second):o=u.positions.first,l=this.elements,e.next=21,l.createNewSheetElement(t,n||a.name,o,c,a.tabColor,a.visibility);case 21:return h=e.sent,e.next=24,l.insertElement(h);case 24:return e.next=26,l.usualSheetChange(l.arrElements);case 26:return this.changeElementsMutation(l),e.next=29,this.saveSheetsTo();case 29:return e.abrupt("break",31);case 30:return e.abrupt("break",31);case 31:e.next=36;break;case 33:throw e.prev=33,e.t1=e["catch"](0),Y["Log"].error("addNewSheet",e.t1);case 36:case"end":return e.stop()}}),e,this,[[0,33]])})));function t(t,n,r,s){return e.apply(this,arguments)}return t}()},{key:"removeElementFromStore",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){var r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=this.elements,e.t0=this.outsideApp,e.next="excelDesktop"===e.t0?4:7;break;case 4:return e.next=6,r.deleteElement(t,n);case 6:return e.abrupt("break",7);case 7:if(s=this.context.rootGetters["AppSettings/getMaintainerStatuses"],!s.areSheetsHaveNumeration){e.next=11;break}return e.next=11,r.usualSheetChange(r.arrElements);case 11:this.changeElementsMutation(r),e.t1=this.outsideApp,e.next="excelDesktop"===e.t1?15:18;break;case 15:return e.next=17,this.saveSheetsTo();case 17:return e.abrupt("break",18);case 18:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"changeSheetPosition",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.items,!(n.length>0)){e.next=8;break}return r=this.elements,e.next=5,r.usualSheetChange(n);case 5:return this.changeElementsMutation(r),e.next=8,this.saveSheetsTo();case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"initializeStoreMutation",value:function(e){this.elements=e}},{key:"cleanNumerationIni",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r,s,i,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,n=t||this.outsideApp,i=this.context.rootGetters["AppSettings/getMaintainerStatuses"],a={typeOfName:"_excelSheetName",delimiter:"_",_classTitle:"SheetElementsMap",maintainerStatuses:i},e.t0=n,e.next="browser"===e.t0?7:"excelDesktop"===e.t0?12:20;break;case 7:return e.next=9,U();case 9:return s=e.sent,r=new re(a),e.abrupt("break",21);case 12:return e.next=14,X.buildWorksheetsClass();case 14:return o=e.sent,e.next=17,o.getWorksheets();case 17:return s=e.sent,r=new re(a),e.abrupt("break",21);case 20:throw Error("source is not defined");case 21:return e.next=23,r._simpleSheetsLoading(s);case 23:return this.initializeStoreMutation(r),this.setOutsideApp(n),e.next=27,this.saveSheetsTo();case 27:return e.next=29,this.getActiveSheet();case 29:e.next=34;break;case 31:throw e.prev=31,e.t1=e["catch"](0),Y["Log"].error("cleanNumerationIni",e.t1);case 34:case"end":return e.stop()}}),e,this,[[0,31]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"initializeStore",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,r,s,i,a,o,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,s=this.context.rootGetters["AppSettings/getMaintainerStatuses"],i={typeOfName:"_excelSheetName",delimiter:"_",_classTitle:"SheetElementsMap",maintainerStatuses:s},a=t||this.outsideApp,e.t0=a,e.next="browser"===e.t0?7:"excelDesktop"===e.t0?12:20;break;case 7:return e.next=9,U();case 9:return r=e.sent,n=new re(i),e.abrupt("break",21);case 12:return e.next=14,X.buildWorksheetsClass();case 14:return o=e.sent,e.next=17,o.getWorksheets();case 17:return r=e.sent,n=new re(i),e.abrupt("break",21);case 20:throw Error("source is not defined");case 21:return e.next=23,n.firstOpenScenarioCreateMatrixElements(r);case 23:if(c=e.sent,c){e.next=26;break}return e.abrupt("return",!1);case 26:return this.initializeStoreMutation(n),this.setOutsideApp(a),e.next=30,this.getActiveSheet();case 30:return e.next=32,this.saveSheetsTo();case 32:return e.abrupt("return",!0);case 35:throw e.prev=35,e.t1=e["catch"](0),Y["Log"].error("initializeStore",e.t1);case 38:case"end":return e.stop()}}),e,this,[[0,35]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"saveSheetsTo",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.t0=this.outsideApp,e.next="browser"===e.t0?3:"excelDesktop"===e.t0?4:10;break;case 3:return e.abrupt("break",10);case 4:return t=this.getExcelSheets,e.next=7,this.changeExcelPositions(t);case 7:return e.next=9,this.changeExcelNames(t);case 9:return e.abrupt("break",10);case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"setExcelContextMutation",value:function(e){this.appContext=e}},{key:"setExcelContext",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.setExcelContextMutation(t);case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"selectSheetMut",value:function(e){this.activeSheetId=e}},{key:"selectSheet",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.t0=this.outsideApp,e.next="excelDesktop"===e.t0?3:9;break;case 3:return e.next=5,X.buildWorksheetsClass();case 5:return n=e.sent,e.next=8,n.setActiveWorksheet(t);case 8:return e.abrupt("break",10);case 9:return e.abrupt("break",10);case 10:this.selectSheetMut(t);case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getActiveSheet",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.t0=this.outsideApp,e.next="excelDesktop"===e.t0?3:14;break;case 3:return e.next=5,X.buildWorksheetsClass();case 5:return t=e.sent,e.next=8,t.getActiveWorksheet();case 8:return n=e.sent,n.load("id"),e.next=12,t.context.sync();case 12:return this.selectSheetMut(n.id),e.abrupt("break",15);case 14:return e.abrupt("break",15);case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"setEditing",value:function(e){this.editingElement=e}},{key:"getExcelSheets",get:function(){return this.elements.getExcelSheets()}},{key:"getSheets",get:function(){return""!=this.filterWord?this.filteredSheets:this.elements.arrElements}},{key:"isInFiltering",get:function(){return""!=this.filterWord}},{key:"getActiveSheetId",get:function(){return this.activeSheetId}},{key:"getEditingElement",get:function(){return this.editingElement}}]),n}(v["d"]);Object(h["a"])([v["c"]],ie.prototype,"setOutsideApp",null),Object(h["a"])([v["c"]],ie.prototype,"setSheetsMutation",null),Object(h["a"])([v["a"]],ie.prototype,"setSheets",null),Object(h["a"])([v["c"]],ie.prototype,"changeElementsMutation",null),Object(h["a"])([v["c"]],ie.prototype,"setFilteredElements",null),Object(h["a"])([v["a"]],ie.prototype,"filterSheetsByWord",null),Object(h["a"])([v["a"]],ie.prototype,"changeExcelNames",null),Object(h["a"])([v["a"]],ie.prototype,"renameSheet",null),Object(h["a"])([v["a"]],ie.prototype,"changeSheetColor",null),Object(h["a"])([v["a"]],ie.prototype,"changeExcelPositions",null),Object(h["a"])([v["a"]],ie.prototype,"addNewSheet",null),Object(h["a"])([v["a"]],ie.prototype,"removeElementFromStore",null),Object(h["a"])([v["a"]],ie.prototype,"changeSheetPosition",null),Object(h["a"])([v["c"]],ie.prototype,"initializeStoreMutation",null),Object(h["a"])([v["a"]],ie.prototype,"cleanNumerationIni",null),Object(h["a"])([v["a"]],ie.prototype,"initializeStore",null),Object(h["a"])([v["a"]],ie.prototype,"saveSheetsTo",null),Object(h["a"])([v["c"]],ie.prototype,"setExcelContextMutation",null),Object(h["a"])([v["a"]],ie.prototype,"setExcelContext",null),Object(h["a"])([v["c"]],ie.prototype,"selectSheetMut",null),Object(h["a"])([v["a"]],ie.prototype,"selectSheet",null),Object(h["a"])([v["a"]],ie.prototype,"getActiveSheet",null),Object(h["a"])([v["c"]],ie.prototype,"setEditing",null),ie=Object(h["a"])([Object(v["b"])({name:"Sheets",namespaced:!0})],ie);var ae=ie,oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("NModal",{attrs:{isActive:e.isActive,"show-save":!1},on:{close:e.close},scopedSlots:e._u([{key:"bookmarks",fn:function(){},proxy:!0},{key:"modalBody",fn:function(){return[n("section",{directives:[{name:"show",rawName:"v-show",value:e.isFeedbackActive,expression:"isFeedbackActive"}],staticClass:"form"},[n("p",{staticClass:"form__p --is-centered --is-iframe-google"},[n("iframe",{attrs:{src:"https://docs.google.com/forms/d/e/1FAIpQLSfTjl0EPEtQW7I1SNexONwSOinC9t3p9gwig3ehR-w4IN-j0g/viewform?embedded=true",frameborder:"0",marginheight:"0",marginwidth:"0"}},[e._v("Loading…")])])])]},proxy:!0}])})},ce=[],ue=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.isChangelogActive=!1,e.isFeedbackActive=!0,e}return Object(c["a"])(n,[{key:"close",value:function(){this.$emit("close",!1)}},{key:"changeTab",value:function(e){0==e&&(this.isChangelogActive=!0,this.isFeedbackActive=!1),1==e&&(this.isFeedbackActive=!0,this.isChangelogActive=!1)}},{key:"isDarkTheme",get:function(){var e=Object(v["e"])(b,this.$store);return e.getIsDarkTheme}}]),n}(m["c"]);ue=Object(h["a"])([Object(m["a"])({props:["isActive"],components:{NModal:D}})],ue);var le=ue,he=le,pe=Object(x["a"])(he,oe,ce,!1,null,null,null),de=pe.exports,me=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.isSearchActive=!1,e.searchingWord="",e.isInfoActive=!1,e}return Object(c["a"])(n,[{key:"searchingWordChange",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Object(v["e"])(ae,this.$store),e.next=3,n.filterSheetsByWord(t);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"turnOnInfo",value:function(){this.isInfoActive=!0}},{key:"closeInfo",value:function(){this.isInfoActive=!1}},{key:"turnOnSettings",value:function(){this.$emit("turn-on-settings")}},{key:"turnOnTutorial",value:function(){var e=Object(v["e"])(b,this.$store);e.switchIntroState()}},{key:"changeIsSearchActive",value:function(e,t){var n=!1;!0===t&&(n=!0),this.searchingWord.length>0&&(n=!0),this.$data.isSearchActive=n||e}},{key:"sync",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=Object(v["e"])(b,this.$store),t.loading(!0),n=Object(v["e"])(ae,this.$store),e.next=5,n.initializeStore();case 5:s=this.$t("alerts.successfulSync"),t.openAlert({title:s,type:r.success});case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"isDarkTheme",get:function(){var e=Object(v["e"])(b,this.$store);return e.getIsDarkTheme}}]),n}(m["c"]);Object(h["a"])([Object(m["d"])("searchingWord")],me.prototype,"searchingWordChange",null),me=Object(h["a"])([Object(m["a"])({name:"navigation-tabs",components:{ModalInfo:de}})],me);var ve=me,fe=ve,ge=Object(x["a"])(fe,H,B,!1,null,"87c4eb56",null),be=ge.exports,ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("vue-nestable",{attrs:{childrenProp:e.childrenProp,maxDepth:e.depth,threshold:30,hooks:{beforeMove:this.nestedHooksBeforeMove}},on:{change:e.changeElements},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.item;return[e.isEditing&&e.editingId==r.id?n("NItem",{attrs:{el:r,id:r.id},on:{"open-colors":e.openColors,"edit-change":function(t){return e.chooseEditing(t,r.id)}}}):n("vue-nestable-handle",{attrs:{item:r}},[n("NItem",{attrs:{el:r,id:r.id},on:{"open-colors":e.openColors,"edit-change":function(t){return e.chooseEditing(t,r.id)}}})],1)]}}]),model:{value:e.els,callback:function(t){e.els=t},expression:"els"}}),e.introIsRunning?n("NItemForIntro",{attrs:{el:e.testItem,id:e.testItem.id},on:{"open-colors":e.openColors}}):e._e(),n("NModal",{attrs:{isActive:e.isColorsOpen,title:e.$t("settings.chooseColor"),"show-save":!1},on:{close:e.closeColors,save:e.saveColors},scopedSlots:e._u([{key:"modalBody",fn:function(){return[n("swatches",{class:{"--is-dark":e.isDarkTheme},attrs:{colors:"material-basic",inline:"","show-fallback":"","popover-to":"left"},on:{close:e.closeColors},model:{value:e.color,callback:function(t){e.color=t},expression:"color"}})]},proxy:!0}])})],1)},ye=[],Oe=n("7f75"),_e=n.n(Oe),we=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"item",class:{"--is-dark":e.isDarkTheme,"--on-edit":e.isEditing},attrs:{id:e.id,draggable:e.isDraggable}},[n("NColorMark",{attrs:{el:e.el},on:{click:e.openColors}}),e._m(0),n("div",[n("NInput",{attrs:{el:e.el,editing:e.isEditing},on:{"input-state-change":e.changeIsEditing}})],1),e.showNumeration?n("div",{directives:[{name:"show",rawName:"v-show",value:!e.isEditing,expression:"!isEditing"}],staticClass:"item-numeration"},[n("i",[e._v(e._s(e.numerationPattern))])]):e._e()],1)},xe=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"item-icon"},[n("i",{staticClass:"fas fa-ellipsis-v"})])}],Se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("figure",{directives:[{name:"touch",rawName:"v-touch:tap",value:e.touched,expression:"touched",arg:"tap"}],staticClass:"item-color",class:{"--has-corner":!e.isTouchDevice,"--is-rounded":e.isTouchDevice},style:{"border-color":e.tabColor,"background-color":e.tabColor},on:{click:e.clicked}})},je=[],Ne=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(c["a"])(n,[{key:"clicked",value:function(){this.$emit("click")}},{key:"touched",value:function(){this.isTouchDevice&&this.clicked()}},{key:"tabColor",get:function(){var e,t=this.$props.el.color;return e=t&&0!=t.length?t:"",e}},{key:"isTouchDevice",get:function(){return!1}}]),n}(m["c"]);Ne=Object(h["a"])([Object(m["a"])({props:["el"],components:{}})],Ne);var Ee,Ce,Re=Ne,Te=Re,Ie=Object(x["a"])(Te,Se,je,!1,null,null,null),$e=Ie.exports,De=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isInputActive?e.isInputActive?n("div",[n("input",{directives:[{name:"outsideClick",rawName:"v-outsideClick",value:{exclude:["input"],handler:"closeEdit"},expression:"{\n\t\t\texclude: ['input'],\n\t\t\thandler: 'closeEdit',\n\t\t}"},{name:"model",rawName:"v-model",value:e.name,expression:"name"}],ref:"input",staticClass:"item-input",attrs:{maxlength:e.maxLength,type:"text"},domProps:{value:e.name},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.closeEdit(t)},input:function(t){t.target.composing||(e.name=t.target.value)}}}),e.isWarningShown?n("div",{staticClass:"item-input-warning"},[e._v(" "+e._s(e.$t("item.nameCannotBeEmpty"))+" ")]):e._e()]):e._e():n("p",{directives:[{name:"touch",rawName:"v-touch:longtap",value:e.edit,expression:"edit",arg:"longtap"},{name:"touch",rawName:"v-touch:tap",value:e.selectWorksheet,expression:"selectWorksheet",arg:"tap"}],staticClass:"item-name",on:{dblclick:function(t){return t.preventDefault(),e.edit(t)},click:function(t){return t.preventDefault(),e.selectWorksheet(t)}}},[e._v(" "+e._s(e.name)+" ")])},Ae=[],We={bind:function(e,t,n){try{Ee=function(r){r.stopPropagation();var s=t.value,i=s.handler,a=s.exclude,o=!1;a.forEach((function(e){if(!o&&n.context){var t=n.context.$refs[e];o=t.contains(r.target)}})),e.contains(r.target)||o||n.context&&n.context[i]()},document.addEventListener("click",Ee),document.addEventListener("touchstart",Ee)}catch(r){console.log("Vue.directive.closable.bind",r)}},unbind:function(){document.removeEventListener("click",Ee),document.removeEventListener("touchstart",Ee)}},Me=We;(function(e){e[e["rename"]=0]="rename",e[e["changeColor"]=1]="changeColor",e[e["delete"]=2]="delete",e[e["create"]=3]="create",e[e["nothing"]=4]="nothing"})(Ce||(Ce={}));var Pe=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.actionType=Ce.nothing,e.maxLength=26,e.isEditing=!1,e.isInputActive=!1,e.element={},e.isWarningShown=!1,e}return Object(c["a"])(n,[{key:"editingChange",value:function(e){this.isEditing=e}},{key:"isEditingChange",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n){var r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t===n){e.next=9;break}if(!t){e.next=7;break}return this.showInput(),e.next=5,this.$nextTick((function(){var e=r.$refs.input;console.log(e),e.focus(),e.select()}));case 5:e.next=9;break;case 7:return e.next=9,this.closeInput();case 9:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"edit",value:function(){this.isEditing=!0}},{key:"closeEdit",value:function(){this.isEditing=!1}},{key:"mounted",value:function(){this.changeEl(this.$props.el),this.editingChange(this.editing)}},{key:"showInput",value:function(){this.$data.isInputActive=!0,this.$emit("input-state-change",!0)}},{key:"closeInput",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.$data.isInputActive=!1,e.next=3,this.elementChange(this.element);case 3:this.$emit("input-state-change",!1);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"changeEl",value:function(e){this.element=e}},{key:"elementChange",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=Object(v["e"])(ae,this.$store),e.t0=this.actionType,e.next=e.t0===Ce.rename?4:7;break;case 4:return e.next=6,n.renameSheet(t);case 6:return e.abrupt("break",8);case 7:return e.abrupt("break",8);case 8:this.actionType=Ce.nothing;case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"selectWorksheet",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=Object(v["e"])(ae,this.$store),e.next=3,t.selectSheet(this.$props.el.sourceId);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"name",set:function(e){e.length<=0?this.isWarningShown=!0:(this.isWarningShown=!1,this.element.encodedName=e,this.actionType=Ce.rename)},get:function(){return this.element.decodedName}}]),n}(m["c"]);Object(h["a"])([Object(m["b"])()],Pe.prototype,"el",void 0),Object(h["a"])([Object(m["b"])({required:!0})],Pe.prototype,"editing",void 0),Object(h["a"])([Object(m["d"])("editing")],Pe.prototype,"editingChange",null),Object(h["a"])([Object(m["d"])("isEditing")],Pe.prototype,"isEditingChange",null),Object(h["a"])([Object(m["d"])("el")],Pe.prototype,"changeEl",null),Pe=Object(h["a"])([Object(m["a"])({components:{},directives:{outsideClick:Me}})],Pe);var Le=Pe,He=Le,Be=Object(x["a"])(He,De,Ae,!1,null,null,null),Fe=Be.exports,ze=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.isEditing=!1,e}return Object(c["a"])(n,[{key:"elm",value:function(e){var t=this.$el.parentElement.parentElement.parentElement;t&&(e?(t.classList.add("--is-active"),this.isDarkTheme&&t.classList.add("--is-dark")):(t.classList.remove("--is-active"),this.isDarkTheme&&t.classList.remove("--is-dark")))}},{key:"changeIsEditing",value:function(e){this.isEditing=e,this.$emit("edit-change",e)}},{key:"editingElementChange",value:function(e){e.id==this.el.id&&(this.isEditing=e.isEditing)}},{key:"mounted",value:function(){this.editingElementChange(this.editingElement)}},{key:"isDraggableChange",value:function(e){var t=this.$el.parentElement;t.setAttribute("draggable","".concat(e))}},{key:"openColors",value:function(){this.$emit("open-colors",this.$props.el)}},{key:"isActive",get:function(){var e=Object(v["e"])(ae,this.$store),t=this.$props.el.sourceId==e.getActiveSheetId;return t}},{key:"editingElement",get:function(){var e=Object(v["e"])(ae,this.$store);return e.getEditingElement}},{key:"isDraggable",get:function(){return!this.isEditing}},{key:"numerationPattern",get:function(){return this.$props.el._numerationPattern()}},{key:"isDarkTheme",get:function(){var e=Object(v["e"])(b,this.$store);return e.getIsDarkTheme}},{key:"showNumeration",get:function(){var e=Object(v["e"])(b,this.$store);return e.getShowNumeration}}]),n}(m["c"]);Object(h["a"])([Object(m["b"])()],ze.prototype,"id",void 0),Object(h["a"])([Object(m["b"])()],ze.prototype,"el",void 0),Object(h["a"])([Object(m["d"])("isActive")],ze.prototype,"elm",null),Object(h["a"])([Object(m["d"])("editingElement")],ze.prototype,"editingElementChange",null),Object(h["a"])([Object(m["d"])("isDraggable")],ze.prototype,"isDraggableChange",null),ze=Object(h["a"])([Object(m["a"])({components:{NInput:Fe,NColorMark:$e}})],ze);var qe=ze,Ve=qe,Ye=Object(x["a"])(Ve,we,xe,!1,null,null,null),Ge=Ye.exports,Xe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"item",class:{"--is-dark":e.isDarkTheme,"--on-edit":e.isEditing,"--is-special":e.isBaseThemeSpecial,"--is-highlighted":e.isItemStep},attrs:{id:e.id,draggable:"isDraggable","data-v-step":"item-whole"}},[n("NColorMark",{attrs:{el:e.el,"data-v-step":"item-color"}}),e._m(0),n("div",{attrs:{"data-v-step":"item-name"}},[n("NInput",{attrs:{el:e.el},on:{"input-state-change":e.changeIsEditing}})],1),e.showNumeration?n("div",{directives:[{name:"show",rawName:"v-show",value:!e.isEditing,expression:"!isEditing"}],staticClass:"item-numeration",attrs:{"data-v-step":"item-numeration"}},[n("i",[e._v(e._s(e.numerationPattern))])]):e._e()],1)},Je=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"item-icon"},[n("i",{staticClass:"fas fa-ellipsis-v"})])}],Ke=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.isEditing=!1,e}return Object(c["a"])(n,[{key:"elm",value:function(e){var t=this.$el.parentElement.parentElement.parentElement;t&&(e?(t.classList.add("--is-active"),this.isDarkTheme&&t.classList.add("--is-dark")):(t.classList.remove("--is-active"),this.isDarkTheme&&t.classList.remove("--is-dark")))}},{key:"changeIsEditing",value:function(e){this.isEditing=e}},{key:"openColors",value:function(){this.$emit("open-colors",this.$props.el)}},{key:"isActive",get:function(){var e=Object(v["e"])(ae,this.$store),t=this.$props.el.sourceId==e.getActiveSheetId;return t}},{key:"isBaseThemeSpecial",get:function(){return this.currentStep>=5&&!this.isDarkTheme}},{key:"isItemStep",get:function(){return 5==this.currentStep}},{key:"isDraggable",get:function(){return!this.isInFiltering&&!this.isEditing}},{key:"isInFiltering",get:function(){var e=Object(v["e"])(ae,this.$store);return e.isInFiltering}},{key:"numerationPattern",get:function(){return this.$props.el._numerationPattern()}},{key:"isDarkTheme",get:function(){var e=Object(v["e"])(b,this.$store);return e.getIsDarkTheme}},{key:"showNumeration",get:function(){var e=Object(v["e"])(b,this.$store);return e.getShowNumeration}},{key:"currentStep",get:function(){var e=Object(v["e"])(b,this.$store);return e.getIntroStep}}]),n}(m["c"]);Object(h["a"])([Object(m["d"])("isActive")],Ke.prototype,"elm",null),Ke=Object(h["a"])([Object(m["a"])({props:["id","el"],components:{NInput:Fe,NColorMark:$e}})],Ke);var Qe=Ke,Ze=Qe,Ue=Object(x["a"])(Ze,Xe,Je,!1,null,null,null),et=Ue.exports,tt=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.testItem=new Q({id:"hola",visibility:"Visible",color:"#ffffff",name:"Test Item Name",first:5,second:0,delimiter:"_",typeOfName:"_excelSheetName",elements:[],_classTitle:"SheetElement"}),e.els=[],e.childrenProp="elements",e.actionType=Ce.nothing,e.isEditing=!1,e.editingId="",e.element={},e.isColorsOpen=!1,e}return Object(c["a"])(n,[{key:"changePElements",value:function(e){this.els=e}},{key:"changeElements",value:function(e){this.$emit("elements-change",this.els)}},{key:"chooseEditing",value:function(e,t){var n=e?t:"";this.editingId=n,this.isEditing=e;var r=Object(v["e"])(ae,this.$store);r.setEditing({isEditing:e,id:n})}},{key:"elementChange",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=Object(v["e"])(ae,this.$store),e.t0=this.actionType,e.next=e.t0===Ce.changeColor?4:7;break;case 4:return e.next=6,n.changeSheetColor(t);case 6:return e.abrupt("break",8);case 7:return e.abrupt("break",8);case 8:this.actionType=Ce.nothing;case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"openColors",value:function(e){this.element=e,this.isColorsOpen=!0}},{key:"closeColors",value:function(){this.isColorsOpen=!1}},{key:"saveColors",value:function(){this.closeColors()}},{key:"nestedHooksBeforeMove",value:function(){return!this.isInFiltering}},{key:"introIsRunning",get:function(){var e=Object(v["e"])(b,this.$store);return e.getIntroIsRunning}},{key:"depth",get:function(){var e=Object(v["e"])(b,this.$store);return e.getMaintainerStatuses.areSheetsHaveNumeration?2:1}},{key:"color",set:function(e){this.element.color=e,this.actionType=Ce.changeColor},get:function(){var e=this.element.color;return e&&"undefined"!=e?e:this.isDarkTheme?"#e1e6e4":"#4f4f4f"}},{key:"isDarkTheme",get:function(){var e=Object(v["e"])(b,this.$store);return e.getIsDarkTheme}},{key:"maintenerStatuses",get:function(){var e=Object(v["e"])(b,this.$store);return e.getMaintainerStatuses}},{key:"isInFiltering",get:function(){var e=Object(v["e"])(ae,this.$store);return e.isInFiltering}}]),n}(m["c"]);Object(h["a"])([Object(m["d"])("pElements")],tt.prototype,"changePElements",null),Object(h["a"])([Object(m["d"])("element",{deep:!0})],tt.prototype,"elementChange",null),tt=Object(h["a"])([Object(m["a"])({props:["pElements"],components:{NItem:Ge,NModal:D,Swatches:_e.a,NItemForIntro:et}})],tt);var nt=tt,rt=nt,st=Object(x["a"])(rt,ke,ye,!1,null,null,null),it=st.exports,at=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.isSettingsActive=!1,e}return Object(c["a"])(n,[{key:"changeElements",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=Object(v["e"])(ae,this.$store),n.isInFiltering){e.next=4;break}return e.next=4,n.changeSheetPosition({items:t});case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changeSettingsState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$data.isSettingsActive=e}},{key:"mounted",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"elements",get:function(){var e=Object(v["e"])(ae,this.$store);return e.getSheets}},{key:"isDarkTheme",get:function(){var e=Object(v["e"])(b,this.$store);return e.getIsDarkTheme}}]),n}(m["c"]);at=Object(h["a"])([Object(m["a"])({components:{NavigationTabs:be,SettingsModal:L,NItems:it}})],at);var ot=at,ct=ot,ut=Object(x["a"])(ct,s,i,!1,null,null,null),lt=ut.exports,ht=n("2b0e"),pt=n("8c4f");ht["a"].use(pt["a"]);var dt=[{path:"/",name:"home",component:lt}],mt=new pt["a"]({routes:dt}),vt=mt,ft={introTour:{"header-help":{title:"Welcome to Sheet Manager!",content:"This tutorial will helps you underastand \n\t\t\thow this addin works - and will always available at \n\t\t\tthis Question Button.\n\t\t\tWe temporary switched to test data to show how it works. \n\t\t\tBy the end of tutorial we will show up Excel sheets."},"header-sync":{title:"Sync button",content:"Important! Any changes in addin are mirroring to Excel automaticly.  \n\t\t\tBut, in case if you change something in Excel and doesn't see it in addin,\n\t\t\tyou can simply click on this Sync Button to synchronize addin and Excel"},"header-info":{title:"Feedback",content:"To send a problem or to share idea"},"header-search":{title:"Search field",content:"is searhing by the name of sheets"},"header-settings":{title:"Settings",content:"are for numeration options, theme switch and etc"},"item-whole":{title:"This is a sheet",content:"simply drag and drop it up or down to change its position "},"item-color":{title:"Sheet tab color",content:"click to change it",placement:"right"},"item-name":{title:"Sheet name",content:"to change - click twice on its name"},"item-numeration":{title:"Sheet tab position",content:"current position number - you can switch visibility in settings"}},settings:{header:"Settings",chooseLanguage:"Language",darkTheme:"Dark theme",sheetsNumerationEnabled:"Sheet numeration (all sheets will numerated)",showNumeration:"Show positions",settingsOnStart:"Settings when addin loaded",openIntroTutorial:"Open intro tutorial",tryToRecoverNumeration:"Try to recover numeration",chooseColor:"Choose Color"},item:{nameCannotBeEmpty:"Name cannot be empty!"},brokenNumeration:{header:"It is possible to recover numeration!",whatWeFound:"We noticed that sheets may have numeration.",tryToRecover:"Try to recover numeration? Warning! All Sheets will be numerated!"},buttons:{yes:"Yes",no:"No",skipTutorial:"Skip tutorial",previousStep:"Previous",nextStep:"Next",finishTour:"Finish"},alerts:{successfulSync:"Synced successfully!",successfulSheetsLoad:"Sheets successfully loaded!",successfulSheetsRecover:"Sheets numeration was successfully recovered!",introTutorialCompleted:"Intro Tutorial passed!",activated:"is on",deactivated:"is off",numerationRecover:"Numeration recover on start",onOpenTutorial:"Open tutorial on start",numeration:"Sheets numeration",numerationVisibility:"Numeration visbility"}},gt={introTour:{"header-help":{title:"Добро пожаловать в Sheet Manager!",content:"Это обучение поможет вам освоиться в программе - \n\t\t\tи всегда будет доступно по выделенному сейчас значку вопроса. \n\t\t\tМы временно переключились на тестовые данные, \n\t\t\tчтобы показать, как всё работает. \n\t\t\tПо оконачнии обучения будут загружены листы Excel"},"header-sync":{title:"Кнопка синхронизации",content:"Обратите внимание! Любые изменения, которые вы сделаете в addin - \n\t\t\tавтоматически синхронизируются с Excel. \n\t\t\tОднако, если вы изменили что-то в Excel и не видите этого в addin - \n\t\t\tпросто нажмите эту кнопку синхронизцаии"},"header-info":{title:"Дополнительная информация",content:"чтобы написать, если что-то не работает или есть идея"},"header-search":{title:"Строка поиска",content:"ищет по названиям листов"},"header-settings":{title:"Настройки",content:"для добавления нумерации, переключения темы и т.д."},"item-whole":{title:"Это лист",content:"его позицию можно поменять, просто его перетянув (drag & drop)"},"item-color":{title:"Цвет листа",content:"можно менять по нажатию",placement:"right"},"item-name":{title:"Название листа",content:"можно изменить дважды кликнув."},"item-numeration":{title:"Нумерация",content:"номер листа по порядку - можно отключить в настройках"}},settings:{header:"Настройки",chooseLanguage:"Язык",darkTheme:"Темная тема",sheetsNumerationEnabled:"Группировка листов (все листы будут пронумерованы)",showNumeration:"Показать нумерацию",settingsOnStart:"Настройки при открытии аддина",openIntroTutorial:"Запускать обучение",tryToRecoverNumeration:"Пробовать восстановить нумерацию",chooseColor:"Выберите цвет"},item:{nameCannotBeEmpty:"Название не может быть пустым!"},brokenNumeration:{header:"Восстановление нумерации",whatWeFound:"Мы обнаружили, что у листов возможно есть нумерация.",tryToRecover:"Попробовать восстановить нумерацию? Внимание! Все листы будут пронумерованы!"},buttons:{yes:"Да",no:"Нет",skipTutorial:"Пропустить обучение",previousStep:"Назад",nextStep:"Дальше",finishTour:"Завершить"},alerts:{successfulSync:"Успешно синхронизировано!",successfulSheetsLoad:"Листы успешно загружены!",successfulSheetsRecover:"Нумерация успешно восстановлена!",introTutorialCompleted:"Обучение пройдено!",activated:"включен",deactivated:"отключен",numerationRecover:"Восставновление нумерации при открытии",onOpenTutorial:"Обучение при открытии",numeration:"Нумерация листов",numerationVisibility:"Видимость нумерации"}},bt={eng:ft,rus:gt},kt=n("2f62");ht["a"].use(kt["a"]);var yt=new kt["a"].Store({modules:{Sheets:ae,AppSettings:b}}),Ot=n("a925"),_t=n("627d"),wt=n.n(_t),xt=(n("b3a4"),n("2536")),St=n.n(xt),jt=n("0086"),Nt=n.n(jt),Et=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{"--is-dark":e.isDarkTheme},attrs:{id:"app"}},[n("router-view"),n("ModalBrokenNavigation",{attrs:{isActive:e.hasBrokenNumeration},on:{"repaire-answer":e.acceptRepaireAnswer}}),n("Alert",{attrs:{title:e.alertState.title,type:e.alertState.type,isActive:e.alertState.isOpen},on:{close:e.closeAlert}}),n("v-tour",{attrs:{name:"tour",steps:e.steps,options:{highlight:!0},callbacks:e.tourCallbacks},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.steps,(function(r,s){return t.currentStep===s?n("v-step",{key:s,attrs:{step:r,"previous-step":t.previousStep,"next-step":t.nextStep,stop:t.stop,"is-first":t.isFirst,"is-last":t.isLast,labels:t.labels,highlight:t.highlight}},[t.isFirst?[n("div",{attrs:{slot:"actions"},slot:"actions"},[n("button",{staticClass:"v-step__button v-step__button-skip",on:{click:t.stop}},[e._v(" "+e._s(e.$t("buttons.skipTutorial"))+" ")]),n("button",{staticClass:"v-step__button v-step__button-next",on:{click:t.nextStep}},[e._v(" "+e._s(e.$t("buttons.nextStep"))+" ")])])]:e._e(),t.isFirst||t.isLast?e._e():[n("div",{attrs:{slot:"actions"},slot:"actions"},[n("button",{staticClass:"v-step__button v-step__button-skip",on:{click:t.stop}},[e._v(" "+e._s(e.$t("buttons.skipTutorial"))+" ")]),n("button",{staticClass:"v-step__button v-step__button-previous",on:{click:t.previousStep}},[e._v(" "+e._s(e.$t("buttons.previousStep"))+" ")]),n("button",{staticClass:"v-step__button v-step__button-next",on:{click:t.nextStep}},[e._v(" "+e._s(e.$t("buttons.nextStep"))+" ")])])],t.isLast?[n("div",{attrs:{slot:"actions"},slot:"actions"},[n("button",{staticClass:"v-step__button v-step__button-previous",on:{click:t.previousStep}},[e._v(" "+e._s(e.$t("buttons.previousStep"))+" ")]),n("button",{staticClass:"v-step__button v-step__button-stop",on:{click:t.stop}},[e._v(" "+e._s(e.$t("buttons.finishTour"))+" ")])])]:e._e()],2):e._e()}))}}])})],1)},Ct=[],Rt=(n("a15b"),n("1276"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("NModal",{attrs:{title:e.$t("brokenNumeration.header"),isActive:e.isActive,"show-save":!1},on:{close:e.close},scopedSlots:e._u([{key:"modalBody",fn:function(){return[n("p",[e._v(" "+e._s(e.$t("brokenNumeration.whatWeFound"))+" ")]),n("p",[e._v(" "+e._s(e.$t("brokenNumeration.tryToRecover"))+" ")]),n("p",{staticClass:"buttons"},[n("button",{staticClass:"button__box --has-border",class:{"--is-dark":e.isDarkTheme},on:{click:function(t){return e.repaire(!0)}}},[e._v(" "+e._s(e.$t("buttons.yes"))+" ")]),n("button",{staticClass:"button__box --has-border",class:{"--is-dark":e.isDarkTheme},on:{click:function(t){return e.repaire(!1)}}},[e._v(" "+e._s(e.$t("buttons.no"))+" ")])])]},proxy:!0}])})}),Tt=[],It=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(c["a"])(n,[{key:"repaire",value:function(e){this.$emit("repaire-answer",e)}},{key:"close",value:function(){this.$emit("repaire-answer",!1)}},{key:"isDarkTheme",get:function(){var e=Object(v["e"])(b,this.$store);return e.getIsDarkTheme}}]),n}(m["c"]);It=Object(h["a"])([Object(m["a"])({props:["isActive"],components:{NModal:D}})],It);var $t=It,Dt=$t,At=Object(x["a"])(Dt,Rt,Tt,!1,null,null,null),Wt=At.exports,Mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"alert",class:e.classMod,on:{click:e.close}},[n("div",{staticClass:"alert-title"},[e._v(e._s(e.title))]),e.disableClose?e._e():n("div",{staticClass:"alert-close"},[e._m(0)]),e.isBodyExists?n("div",{staticClass:"alert-body"},[e._t("body")],2):e._e()])},Pt=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"icon"},[n("i",{staticClass:"fas fa-times"})])}],Lt=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(c["a"])(n,[{key:"close",value:function(){this.disableClose||this.$emit("close")}},{key:"isBodyExists",get:function(){return void 0!==this.$slots.body}},{key:"disableClose",get:function(){switch(this.$props.type){case r.loading:return!0;case r.dimmer:return!0}return!1}},{key:"classMod",get:function(){var e=this.$props.isActive?"--is-active ":"";switch(this.$props.type){case r.danger:return e+"--is-danger";case r.success:return e+"--is-success";case r.loading:return e+"--is-loading";case r.dimmer:return e+"--is-dimmer"}}}]),n}(m["c"]);Lt=Object(h["a"])([Object(m["a"])({props:["type","isActive","title"]})],Lt);var Ht=Lt,Bt=Ht,Ft=Object(x["a"])(Bt,Mt,Pt,!1,null,null,null),zt=Ft.exports,qt=function(){for(var e=Zt.locale,t=Zt.messages[e],n=[],r=0,s=Object.entries(t.introTour);r<s.length;r++){var i=Object(F["a"])(s[r],2),a=i[0],o=i[1],c={target:"[data-v-step=".concat(a,"]"),header:{title:o.title},content:o.content};o.placement&&(c.params=c.params?c.params:c.params={},c.params.placement=o.placement),n.push(c)}return n},Vt=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.tourCallbacks={onStart:e.enableDimmer,onStop:e.disableDimmer,onNextStep:e.introOnNextStep,onPreviousStep:e.introOnPreviousStep},e.tourCurrentStep=0,e.hostInfo=void 0,e.sourceApp="excelDesktop",e.hasBrokenNumeration=!1,e.iniStore=!1,e.title={lang:"lang",storeAppSettings:"appSettings"},e.isMounted=!1,e}return Object(c["a"])(n,[{key:"enableDimmer",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=Object(v["e"])(b,this.$store),t.dimmer(!0),e.next=4,this.mountTestData();case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"disableDimmer",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=Object(v["e"])(b,this.$store),t.dimmer(!1),e.next=4,this.switchIntroIsRunning();case 4:n=this.$t("alerts.introTutorialCompleted"),t.openAlert({title:n,type:r.success}),setTimeout((function(){s.sourceApp="excelDesktop",s.continueMounted()}),1e3);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"switchIntroIsRunning",value:function(){var e=Object(v["e"])(b,this.$store);e.switchIntroState()}},{key:"introIsRunningChange",value:function(e){if(e){this.$tours["tour"].start();var t=Object(v["e"])(b,this.$store);this.tourCurrentStep=0,t.setIntroStep(this.tourCurrentStep)}}},{key:"startTour",value:function(){this.switchIntroIsRunning()}},{key:"introOnPreviousStep",value:function(){this.introOnStep(!0)}},{key:"introOnNextStep",value:function(){this.introOnStep(!1)}},{key:"introOnStep",value:function(e){var t=Object(v["e"])(b,this.$store);e?this.tourCurrentStep-=1:this.tourCurrentStep+=1,t.setIntroStep(this.tourCurrentStep)}},{key:"iniStoreChange",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=Object(v["e"])(ae,this.$store),e.next=3,t.initializeStore(this.sourceApp);case 3:e.sent;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"closeAlert",value:function(){var e=Object(v["e"])(b,this.$store);e.closeAlert()}},{key:"appSettingsChange",value:function(){this.isLocalStorageExists&&localStorage.setItem(this.title.storeAppSettings,JSON.stringify(this.appSettings))}},{key:"acceptRepaireAnswer",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Object(v["e"])(b,this.$store),n.loading(!0),e.next=4,n.switchSheetsNumeration(t);case 4:this.iniStore=!this.iniStore,this.hasBrokenNumeration=!1,s=t?this.$t("alerts.successfulSheetsRecover"):this.$t("alerts.successfulSheetsLoad"),n.openAlert({title:s,type:r.success});case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"checkIsTouchDevice",value:function(){try{var e=" -webkit- -moz- -o- -ms- ".split(" "),t=function(e){return window.matchMedia(e).matches};if("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)return!0;var n=["(",e.join("touch-enabled),("),"heartz",")"].join(""),r=t(n),s=Object(v["e"])(b,this.$store);s.setIsTouchDevice(r)}catch(i){throw Y["Log"].error("App.checkIsTouchDevice",i)}}},{key:"eventHandler",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=Object(v["e"])(ae,this.$store),e.t0=t.type,e.next="WorksheetSingleClicked"===e.t0?4:"WorksheetActivated"===e.t0?5:"WorksheetDeleted"===e.t0?7:"WorksheetAdded"===e.t0?10:"WorksheetFormatChanged"===e.t0?13:"WorksheetChanged"===e.t0?14:15;break;case 4:return e.abrupt("break",15);case 5:return n.selectSheetMut(t.worksheetId),e.abrupt("break",15);case 7:return e.next=9,n.removeElementFromStore(t.worksheetId);case 9:return e.abrupt("break",15);case 10:return e.next=12,n.addNewSheet(t.worksheetId);case 12:return e.abrupt("break",15);case 13:return e.abrupt("break",15);case 14:return e.abrupt("break",15);case 15:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"currentLangChange",value:function(e){localStorage.setItem(this.title.lang,e)}},{key:"mounted",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=Object(v["e"])(b,this.$store),this.isLocalStorageExists&&(n=localStorage.getItem(this.title.storeAppSettings),n&&(this.appSettings=JSON.parse(n)),r=localStorage.getItem(this.title.lang),r&&(this.currentLang=r)),!t.getRunIntroOnOpen){e.next=5;break}return this.startTour(),e.abrupt("return");case 5:return e.next=7,this.continueMounted();case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"continueMounted",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n,s,i,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=Object(v["e"])(b,this.$store),t.loading(!0),n=Object(v["e"])(ae,this.$store),"excelDesktop"!=this.sourceApp){e.next=19;break}return e.prev=4,e.next=7,V.init();case 7:return s=e.sent,i=s.workbook.worksheets,i.onActivated.add(this.eventHandler),i.onAdded.add(this.eventHandler),i.onDeleted.add(this.eventHandler),e.next=14,s.sync();case 14:e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](4),this.sourceApp="browser";case 19:return this.checkIsTouchDevice(),console.log("continue mounted",this.sourceApp),e.next=23,n.initializeStore(this.sourceApp);case 23:if(a=e.sent,console.log("m",this.sourceApp),a){e.next=29;break}return this.hasBrokenNumeration=!0,t.loading(!1),e.abrupt("return");case 29:this.hasBrokenNumeration=!1,o=this.$t("alerts.successfulSheetsLoad"),t.openAlert({title:o,type:r.success}),this.isMounted=!0;case 33:case"end":return e.stop()}}),e,this,[[4,16]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"mountTestData",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=Object(v["e"])(ae,this.$store),e.next=3,t.initializeStore("browser");case 3:e.sent,this.hasBrokenNumeration=!1;case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"beforeDestroy",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("excelDesktop"!=this.sourceApp){e.next=10;break}return e.next=3,V.init();case 3:return t=e.sent,n=t.workbook.worksheets,n.onActivated.remove(this.eventHandler),n.onAdded.remove(this.eventHandler),n.onDeleted.remove(this.eventHandler),e.next=10,t.sync();case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"introIsRunning",get:function(){var e=Object(v["e"])(b,this.$store);return e.getIntroIsRunning}},{key:"steps",get:function(){return qt()}},{key:"alertState",get:function(){var e=Object(v["e"])(b,this.$store);return e.getAlertState}},{key:"isDarkTheme",get:function(){var e=Object(v["e"])(b,this.$store);return e.getIsDarkTheme}},{key:"isLocalStorageExists",get:function(){return"undefined"!=typeof localStorage}},{key:"appSettings",set:function(e){var t=Object(v["e"])(b,this.$store);t.setAllSettings(e)},get:function(){var e=Object(v["e"])(b,this.$store);return e.getAllSettings}},{key:"currentLang",get:function(){return this.$i18n.locale},set:function(e){this.$i18n.locale=e}}]),n}(m["c"]);Object(h["a"])([Object(m["d"])("introIsRunning")],Vt.prototype,"introIsRunningChange",null),Object(h["a"])([Object(m["d"])("iniStore")],Vt.prototype,"iniStoreChange",null),Object(h["a"])([Object(m["d"])("appSettings")],Vt.prototype,"appSettingsChange",null),Object(h["a"])([Object(m["d"])("currentLang")],Vt.prototype,"currentLangChange",null),Vt=Object(h["a"])([Object(m["a"])({components:{ModalBrokenNavigation:Wt,Alert:zt}})],Vt);var Yt,Gt=Vt,Xt=Gt,Jt=Object(x["a"])(Xt,Et,Ct,!1,null,null,null),Kt=Jt.exports,Qt=n("9483");Object(Qt["a"])("".concat("/sheets_manager_excel_addin/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}}),ht["a"].use(wt.a),n("2440"),ht["a"].use(St.a),ht["a"].use(Ot["a"]),ht["a"].use(Nt.a),ht["a"].config.productionTip=!1;var Zt=new Ot["a"]({locale:R.rus,messages:bt}),Ut=window.sessionStorage["hostInfoValue"],en="excelDesktop",tn="browser";switch(void 0==Ut){case!0:console.log("I'm an outsider"),Yt=new ht["a"]({i18n:Zt,router:vt,store:yt,render:function(e){return e(Kt)}}).$mount("#app"),Yt.$children[0].$data.sourceApp=tn;break;default:console.log("I'm an office man"),Office.onReady((function(e){Yt=new ht["a"]({el:"#app",i18n:Zt,router:vt,store:yt,render:function(e){return e(Kt)}}),Yt.$children[0].$data.sourceApp=en,Yt.$children[0].$data.hostInfo=e}));break}},ce4a:function(e,t,n){var r;n("4160"),n("c975"),n("b64b"),n("d3b7"),n("ac1f"),n("25f0"),n("1276"),n("159b"),function(e){"use strict";var t=function(){function e(){this._dropEffect="move",this._effectAllowed="all",this._data={}}return Object.defineProperty(e.prototype,"dropEffect",{get:function(){return this._dropEffect},set:function(e){this._dropEffect=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectAllowed",{get:function(){return this._effectAllowed},set:function(e){this._effectAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"types",{get:function(){return Object.keys(this._data)},enumerable:!0,configurable:!0}),e.prototype.clearData=function(e){null!=e?delete this._data[e]:this._data=null},e.prototype.getData=function(e){return this._data[e]||""},e.prototype.setData=function(e,t){this._data[e]=t},e.prototype.setDragImage=function(e,t,r){var s=n._instance;s._imgCustom=e,s._imgOffset={x:t,y:r}},e}();e.DataTransfer=t;var n=function(){function e(){if(this._lastClick=0,e._instance)throw"DragDropTouch instance already created.";var t=!1;if(document.addEventListener("test",(function(){}),{get passive(){return t=!0,!0}}),"ontouchstart"in document){var n=document,r=this._touchstart.bind(this),s=this._touchmove.bind(this),i=this._touchend.bind(this),a=!!t&&{passive:!1,capture:!1};n.addEventListener("touchstart",r,a),n.addEventListener("touchmove",s,a),n.addEventListener("touchend",i),n.addEventListener("touchcancel",i)}}return e.getInstance=function(){return e._instance},e.prototype._touchstart=function(t){var n=this;if(this._shouldHandle(t)){if(Date.now()-this._lastClick<e._DBLCLICK&&this._dispatchEvent(t,"dblclick",t.target))return t.preventDefault(),void this._reset();this._reset();var r=this._closestDraggable(t.target);r&&(this._dispatchEvent(t,"mousemove",t.target)||this._dispatchEvent(t,"mousedown",t.target)||(this._dragSource=r,this._ptDown=this._getPoint(t),this._lastTouch=t,t.preventDefault(),setTimeout((function(){n._dragSource==r&&null==n._img&&n._dispatchEvent(t,"contextmenu",r)&&n._reset()}),e._CTXMENU),e._ISPRESSHOLDMODE&&(this._pressHoldInterval=setTimeout((function(){n._isDragEnabled=!0,n._touchmove(t)}),e._PRESSHOLDAWAIT))))}},e.prototype._touchmove=function(e){if(this._shouldCancelPressHoldMove(e))this._reset();else if(this._shouldHandleMove(e)||this._shouldHandlePressHoldMove(e)){var t=this._getTarget(e);if(this._dispatchEvent(e,"mousemove",t))return this._lastTouch=e,void e.preventDefault();this._dragSource&&!this._img&&this._shouldStartDragging(e)&&(this._dispatchEvent(e,"dragstart",this._dragSource),this._createImage(e),this._dispatchEvent(e,"dragenter",t)),this._img&&(this._lastTouch=e,e.preventDefault(),t!=this._lastTarget&&(this._dispatchEvent(this._lastTouch,"dragleave",this._lastTarget),this._dispatchEvent(e,"dragenter",t),this._lastTarget=t),this._moveImage(e),this._isDropZone=this._dispatchEvent(e,"dragover",t))}},e.prototype._touchend=function(e){if(this._shouldHandle(e)){if(this._dispatchEvent(this._lastTouch,"mouseup",e.target))return void e.preventDefault();this._img||(this._dragSource=null,this._dispatchEvent(this._lastTouch,"click",e.target),this._lastClick=Date.now()),this._destroyImage(),this._dragSource&&(e.type.indexOf("cancel")<0&&this._isDropZone&&this._dispatchEvent(this._lastTouch,"drop",this._lastTarget),this._dispatchEvent(this._lastTouch,"dragend",this._dragSource),this._reset())}},e.prototype._shouldHandle=function(e){return e&&!e.defaultPrevented&&e.touches&&e.touches.length<2},e.prototype._shouldHandleMove=function(t){return!e._ISPRESSHOLDMODE&&this._shouldHandle(t)},e.prototype._shouldHandlePressHoldMove=function(t){return e._ISPRESSHOLDMODE&&this._isDragEnabled&&t&&t.touches&&t.touches.length},e.prototype._shouldCancelPressHoldMove=function(t){return e._ISPRESSHOLDMODE&&!this._isDragEnabled&&this._getDelta(t)>e._PRESSHOLDMARGIN},e.prototype._shouldStartDragging=function(t){var n=this._getDelta(t);return n>e._THRESHOLD||e._ISPRESSHOLDMODE&&n>=e._PRESSHOLDTHRESHOLD},e.prototype._reset=function(){this._destroyImage(),this._dragSource=null,this._lastTouch=null,this._lastTarget=null,this._ptDown=null,this._isDragEnabled=!1,this._isDropZone=!1,this._dataTransfer=new t,clearInterval(this._pressHoldInterval)},e.prototype._getPoint=function(e,t){return e&&e.touches&&(e=e.touches[0]),{x:t?e.pageX:e.clientX,y:t?e.pageY:e.clientY}},e.prototype._getDelta=function(t){if(e._ISPRESSHOLDMODE&&!this._ptDown)return 0;var n=this._getPoint(t);return Math.abs(n.x-this._ptDown.x)+Math.abs(n.y-this._ptDown.y)},e.prototype._getTarget=function(e){var t=this._getPoint(e),n=document.elementFromPoint(t.x,t.y);while(n&&"none"==getComputedStyle(n).pointerEvents)n=n.parentElement;return n},e.prototype._createImage=function(t){this._img&&this._destroyImage();var n=this._imgCustom||this._dragSource;if(this._img=n.cloneNode(!0),this._copyStyle(n,this._img),this._img.style.top=this._img.style.left="-9999px",!this._imgCustom){var r=n.getBoundingClientRect(),s=this._getPoint(t);this._imgOffset={x:s.x-r.left,y:s.y-r.top},this._img.style.opacity=e._OPACITY.toString()}this._moveImage(t),document.body.appendChild(this._img)},e.prototype._destroyImage=function(){this._img&&this._img.parentElement&&this._img.parentElement.removeChild(this._img),this._img=null,this._imgCustom=null},e.prototype._moveImage=function(e){var t=this;requestAnimationFrame((function(){if(t._img){var n=t._getPoint(e,!0),r=t._img.style;r.position="absolute",r.pointerEvents="none",r.zIndex="999999",r.left=Math.round(n.x-t._imgOffset.x)+"px",r.top=Math.round(n.y-t._imgOffset.y)+"px"}}))},e.prototype._copyProps=function(e,t,n){for(var r=0;r<n.length;r++){var s=n[r];e[s]=t[s]}},e.prototype._copyStyle=function(t,n){if(e._rmvAtts.forEach((function(e){n.removeAttribute(e)})),t instanceof HTMLCanvasElement){var r=t,s=n;s.width=r.width,s.height=r.height,s.getContext("2d").drawImage(r,0,0)}for(var i=getComputedStyle(t),a=0;a<i.length;a++){var o=i[a];o.indexOf("transition")<0&&(n.style[o]=i[o])}n.style.pointerEvents="none";for(a=0;a<t.children.length;a++)this._copyStyle(t.children[a],n.children[a])},e.prototype._dispatchEvent=function(t,n,r){if(t&&r){var s=document.createEvent("Event"),i=t.touches?t.touches[0]:t;return s.initEvent(n,!0,!0),s.button=0,s.which=s.buttons=1,this._copyProps(s,t,e._kbdProps),this._copyProps(s,i,e._ptProps),s.dataTransfer=this._dataTransfer,r.dispatchEvent(s),s.defaultPrevented}return!1},e.prototype._closestDraggable=function(e){for(;e;e=e.parentElement)if(e.hasAttribute("draggable")&&e.draggable)return e;return null},e}();n._instance=new n,n._THRESHOLD=5,n._OPACITY=.5,n._DBLCLICK=500,n._CTXMENU=900,n._ISPRESSHOLDMODE=!1,n._PRESSHOLDAWAIT=400,n._PRESSHOLDMARGIN=25,n._PRESSHOLDTHRESHOLD=0,n._rmvAtts="id,class,style,draggable".split(","),n._kbdProps="altKey,ctrlKey,metaKey,shiftKey".split(","),n._ptProps="pageX,pageY,clientX,clientY,screenX,screenY".split(","),e.DragDropTouch=n}(r||(r={}))},e317:function(e,t,n){"use strict";n.r(t),n.d(t,"Log",(function(){return i}));n("99af");var r=n("d4ec"),s=n("bee2"),i=function(){function e(t){Object(r["a"])(this,e),this.classTitle=t}return Object(s["a"])(e,[{key:"error",value:function(e,t){console.error("".concat(this.classTitle,": ").concat(e),t)}},{key:"log",value:function(e){console.log("".concat(this.classTitle,": ").concat(e))}}],[{key:"error",value:function(e,t){console.error("".concat(e),t)}},{key:"log",value:function(e){console.log("".concat(e))}}]),e}()}});